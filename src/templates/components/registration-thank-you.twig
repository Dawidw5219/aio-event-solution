{# Registration Thank You Component #}
{# 
  Parameters:
  - visible: boolean - whether to show immediately (for redirect) or hide (for AJAX)
  - show_email: boolean - whether to show email field (for AJAX)
  - event: Timber\Post - event post object (optional)
#}
{% set visible = visible|default(false) %}
{% set show_email = show_email|default(false) %}
{% set event = event|default(null) %}

{% set event_date = event ? event.meta('_aio_event_start_date') : null %}
{% set event_time = event ? event.meta('_aio_event_start_time') : null %}
{% set event_subtitle = event ? event.meta('_aio_event_subtitle') : null %}
{% set timezone_string = function('wp_timezone_string') %}
{# Calculate UTC timestamps from event date/time in WP timezone #}
{% set utc_times = function('AIOEvents\\aio_event_utc_times', event_date, event_time, 1) %}

	<div class="aio-events-registration-success" {% if not visible %} style="display: none;" {% endif %} {% if event %} data-event-title="{{ event.title|e('html_attr') }}" data-event-subtitle="{{ event_subtitle|e('html_attr') }}" data-event-id="{{ event.ID }}" data-utc-start="{{ utc_times.start }}" data-utc-end="{{ utc_times.end }}" data-calendar-notice="{{ function('__', 'The event link will be sent to your registered email shortly before the event starts.', 'aio-event-solution')|e('html_attr') }}" {% endif %}> <div class="bg-green-50 border-2 border-green-200 rounded-2xl text-center overflow-hidden p-8">
		<div class="mb-4">
			<svg class="w-16 h-16 mx-auto text-green-600" fill="none" stroke="currentColor" viewbox="0 0 24 24">
				<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
			</svg>
		</div>
		<h3 class="text-2xl font-bold text-green-800 mb-4">
			{{ function('__', 'Thank you for registering!', 'aio-event-solution') }}
		</h3>

		{# Add to Calendar buttons - right after title #}
		{% if event and event_date %}
			<div
				class="flex flex-wrap justify-center gap-3 mb-6">
				{# Google Calendar #}
				<a href="#" class="aio-calendar-btn aio-calendar-google inline-flex items-center gap-2 px-4 py-2.5 bg-white border border-green-300 rounded-lg text-sm font-medium text-green-800 hover:bg-green-50 hover:border-green-400 transition-colors shadow-sm">
					<svg class="w-5 h-5" viewbox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
						<path fill="#FFFFFF" d="M152.637,47.368l-47.368-5.263l-57.895,5.263L42.105,100l5.263,52.632l52.632,6.579l52.632-6.579l5.263-53.947L152.637,47.368z"/>
						<path fill="#1A73E8" d="M68.961,128.526c-3.934-2.658-6.658-6.539-8.145-11.671l9.132-3.763c0.829,3.158,2.276,5.605,4.342,7.342c2.053,1.737,4.553,2.592,7.474,2.592c2.987,0,5.553-0.908,7.697-2.724s3.224-4.132,3.224-6.934c0-2.868-1.132-5.211-3.395-7.026s-5.105-2.724-8.5-2.724h-5.276v-9.039H80.25c2.921,0,5.382-0.789,7.382-2.368c2-1.579,3-3.737,3-6.487c0-2.447-0.895-4.395-2.684-5.855s-4.053-2.197-6.803-2.197c-2.684,0-4.816,0.711-6.395,2.145s-2.724,3.197-3.447,5.276l-9.039-3.763c1.197-3.395,3.395-6.395,6.618-8.987c3.224-2.592,7.342-3.895,12.342-3.895c3.697,0,7.026,0.711,9.974,2.145c2.947,1.434,5.263,3.421,6.934,5.947c1.671,2.539,2.5,5.382,2.5,8.539c0,3.224-0.776,5.947-2.329,8.184c-1.553,2.237-3.461,3.947-5.724,5.145v0.539c2.987,1.25,5.421,3.158,7.342,5.724c1.908,2.566,2.868,5.632,2.868,9.211s-0.908,6.776-2.724,9.579c-1.816,2.803-4.329,5.013-7.513,6.618c-3.197,1.605-6.789,2.421-10.776,2.421C77.158,132.513,72.895,131.184,68.961,128.526z"/>
						<path fill="#1A73E8" d="M125,83.211l-9.974,7.25l-5.013-7.605l17.987-12.974h6.895v61.197H125V83.211z"/>
						<path fill="#EA4335" d="M152.637,200l47.368-47.368l-23.684-10.526l-23.684,10.526l-10.526,23.684L152.637,200z"/>
						<path fill="#34A853" d="M36.842,176.316l10.526,23.684h105.263v-47.368H47.368L36.842,176.316z"/>
						<path fill="#4285F4" d="M15.789,0C7.066,0,0,7.066,0,15.789v136.842l23.684,10.526l23.684-10.526V47.368h105.263l10.526-23.684L152.632,0H15.789z"/>
						<path fill="#188038" d="M0,152.632v31.579C0,192.934,7.066,200,15.789,200h31.579v-47.368H0z"/>
						<path fill="#FBBC04" d="M152.637,47.368v105.263H200V47.368l-23.684-10.526L152.637,47.368z"/>
						<path fill="#1967D2" d="M200,47.368V15.789C200,7.066,192.934,0,184.211,0h-31.579v47.368H200z"/>
					</svg>
					<span>{{ function('__', 'Add to Google Calendar', 'aio-event-solution') }}</span>
				</a>

				{# Outlook Calendar #}
				<a href="#" class="aio-calendar-btn aio-calendar-outlook inline-flex items-center gap-2 px-4 py-2.5 bg-white border border-green-300 rounded-lg text-sm font-medium text-green-800 hover:bg-green-50 hover:border-green-400 transition-colors shadow-sm">
					<svg class="w-5 h-5" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
						<path fill="#0078D4" d="M24 7.387v10.478c0 .23-.08.424-.238.576a.806.806 0 01-.59.234h-8.86v-6.521l1.496 1.063a.39.39 0 00.478 0l7.714-5.457V7.387z"/>
						<path fill="#0078D4" d="M8.858 9.088l.578-.303.372-.188 4.475-2.263c.163-.085.32-.085.478 0l.372.188 8.867 4.49V7.387a.806.806 0 00-.238-.576.806.806 0 00-.59-.234H9.74l-.882 2.511z"/>
						<path fill="#28A8EA" d="M14.312 6.577V18.17l-5.454-3.014V9.088l5.454-2.511z"/>
						<path fill="#0364B8" d="M0 5.39v13.22c0 .39.132.722.396.996.263.274.587.41.972.41h12.944V5.984H1.368c-.385 0-.71.137-.972.41A1.391 1.391 0 000 7.39v-2z"/>
						<path fill="#FFFFFF" d="M7.113 8.74c-.627 0-1.164.132-1.61.396-.446.264-.79.643-1.031 1.138-.24.494-.36 1.082-.36 1.763 0 .66.116 1.234.35 1.721.231.488.56.863.987 1.126.427.264.934.396 1.521.396.621 0 1.154-.132 1.597-.396.444-.264.785-.639 1.023-1.126.238-.487.357-1.061.357-1.72 0-.67-.117-1.251-.35-1.745-.234-.494-.567-.875-.999-1.145-.432-.27-.945-.405-1.537-.408h.052zm-.052 1.194c.337 0 .616.087.836.262.22.175.385.42.494.735.11.315.165.682.165 1.1 0 .413-.055.78-.165 1.1-.11.322-.277.573-.502.754-.225.18-.506.271-.843.271-.343 0-.627-.09-.852-.271-.225-.18-.393-.432-.502-.754a3.42 3.42 0 01-.165-1.1c0-.418.055-.785.165-1.1.11-.315.277-.56.502-.735.225-.175.506-.262.843-.262h.024z"/>
					</svg>
					<span>{{ function('__', 'Add to Outlook', 'aio-event-solution') }}</span>
				</a>

				{# Download .ics file #}
				<a href="#" class="aio-calendar-btn aio-calendar-ics inline-flex items-center gap-2 px-4 py-2.5 bg-white border border-green-300 rounded-lg text-sm font-medium text-green-800 hover:bg-green-50 hover:border-green-400 transition-colors shadow-sm">
					<svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
					</svg>
					<span>{{ function('__', 'Download .ics', 'aio-event-solution') }}</span>
				</a>
			</div>
		{% endif %}

		{# Event information #}
		{% if event %}
			<div class="mb-4 pt-4 border-t border-green-200">
				<h4 class="text-lg font-semibold text-green-900 mb-2">
					{{ event.title }}
				</h4>

				{% if event_subtitle %}
					<p class="text-green-800 mb-2">
						{{ event_subtitle }}
					</p>
				{% endif %}

				{% if event_date or event_time %}
					<div class="flex items-center justify-center gap-2 text-green-700">
						{% if event_date %}
							<div class="flex items-center gap-1">
								<svg class="w-4 h-4" fill="none" stroke="currentColor" viewbox="0 0 24 24">
									<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
								</svg>
								<span>{{ event_date|date('d.m.Y') }}</span>
							</div>
						{% endif %}
						{% if event_time %}
							{% if event_date %}
								<span>â€¢</span>
							{% endif %}
							<div class="flex items-center gap-1">
								<svg class="w-4 h-4" fill="none" stroke="currentColor" viewbox="0 0 24 24">
									<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
								</svg>
								<span>{{ event_time }}
									({{ timezone_string }})</span>
							</div>
						{% endif %}
					</div>
				{% endif %}
			</div>
		{% endif %}

		{# Email confirmation message #}
		{% if show_email %}
			<p class="aio-events-success-email text-green-700 mt-4">
				{{ function('__', 'Confirmation email has been sent to:', 'aio-event-solution') }}
				<strong class="aio-events-success-email-value block mt-2 text-lg text-green-800"></strong>
			</p>
		{% else %}
			<p class="text-green-700 mt-4">
				{{ function('__', 'Confirmation email has been sent.', 'aio-event-solution') }}
			</p>
		{% endif %}
	</div>
</div>
